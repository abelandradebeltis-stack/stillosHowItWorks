<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Fluxos da aplicação - (Referência - Vídeo gerar pagamento)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <script type="importmap">
  {
    "imports": {
      "bootstrap": "https://esm.sh/bootstrap@5.3.2"
    }
  }
  </script>
</head>
<body class="d-flex flex-column vh-100 bg-light">
  <div class="container py-4">
    <header class="d-flex align-items-center mb-2 mx-auto" style="max-width:980px;">
      <div class="me-3">
        <img src="/stillos-logo.png" alt="STILLOS logo" class="brand-logo" width="72" height="72" />
      </div>
      <div>
        <h1 class="h4 mb-0">Manual interativo — Fechamento SQL + Comissões</h1>
        <small class="text-muted">Procedimentos passo a passo com recursos interativos</small>
      </div>
      <a href="../index.html" class="btn btn-sm btn-outline-primary ms-auto">Voltar ao início</a>
    </header>
    <div class="container py-2" id="app">
  <div class="card shadow-sm manual-card">
    <div class="card-body p-3 p-md-4">
      <div class="d-flex align-items-center mb-3">
        <div class="me-3">
        </div>
      </div>

      <!-- Quick controls -->
      <div class="d-flex gap-2 mb-3 flex-wrap">
        <input id="search" class="form-control form-control-sm flex-fill" placeholder="Buscar seção, comando ou palavra-chave" />
        <button id="checkAll" class="btn btn-outline-primary btn-sm" style="background-color: deeppink; color: white; border: none">Marcar tudo</button>
        <button id="uncheckAll" class="btn btn-outline-secondary btn-sm">Desmarcar</button>
      </div>

      <!-- Accordion with sections -->
      <div class="accordion" id="manualAccordion">

        <!-- 1 Objective -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-1">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-1" aria-expanded="false" aria-controls="collapse-1">
              1. Objetivo do Processo
            </button>
          </h2>
          <div id="collapse-1" class="accordion-collapse collapse" aria-labelledby="heading-1" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ol class="mb-0">
                <li>Finalizar o fechamento mensal no sistema SQL.</li>
                <li>Ajustar datas, códigos de fechamento e parâmetros de pagamento na folha SQL.</li>
                <li>Rodar SELECTs de validação.</li>
                <li>Corrigir inconsistências com UPDATE.</li>
                <li>Executar etapa final das comissões garantindo valores corretos.</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- 2 Before start -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-2">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-2" aria-expanded="false" aria-controls="collapse-2">
              2. Antes de Começar
            </button>
          </h2>
          <div id="collapse-2" class="accordion-collapse collapse" aria-labelledby="heading-2" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ul>
                <li>Verificar mensagem: "Fechamento processado com sucesso".</li>
                <li>Confirmar que a folha SQL contém bloco de SELECTs + UPDATEs.</li>
                <li>Saber o código de fechamento do mês (ex.: 318) e a nova data (ex.: 01/02/2025).</li>
              </ul>
              <div class="mt-2">
                <label class="form-label small mb-1">Anote aqui (ex.: código / data)</label>
                <div class="d-flex gap-2">
                  <input id="campoCodigo" class="form-control form-control-sm" placeholder="Código de fechamento (ex.: 318)">
                  <input id="campoData" class="form-control form-control-sm" placeholder="Data nova (ex.: 01/02/2025)">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 3 Ajustes Iniciais -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-3">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-3" aria-expanded="false" aria-controls="collapse-3">
              3. Ajustes Iniciais na Folha SQL
            </button>
          </h2>
          <div id="collapse-3" class="accordion-collapse collapse" aria-labelledby="heading-3" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ol>
                <li><strong>Abrir folha de pagamento</strong> (arquivo SQL utilizado).</li>
                <li><strong>Alterar "recebe em" e "código do fechamento"</strong> para os valores novos.</li>
                <li><strong>Usar Find & Replace nas datas</strong> (Ctrl+F → Replace All). Se erro: Ctrl+Z.</li>
              </ol>

              <div class="mt-3">
                <label class="form-label small">Exemplos de substituição</label>
                <pre class="sql-block" id="exampleReplace">-- Antes
UPDATE folha SET recebe_em = '01/01/2025' WHERE codigo = 317;

-- Depois (substituir '01/01/2025' por '01/02/2025')
UPDATE folha SET recebe_em = '01/02/2025' WHERE codigo = 318;</pre>
                <div class="d-flex gap-2 mt-2">
                  <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#exampleReplace">Copiar exemplo</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 4 Rodando SELECTs -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-4">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-4" aria-expanded="false" aria-controls="collapse-4">
              4. Rodando os SELECTs de Validação
            </button>
          </h2>
          <div id="collapse-4" class="accordion-collapse collapse" aria-labelledby="heading-4" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ol>
                <li>Rodar apenas o primeiro SELECT do bloco inicial — verifica inconsistências.</li>
                <li>Rodar o SELECT seguinte (até 2017, quando aplicável).</li>
              </ol>
              <p class="mb-0"><strong>Resultado:</strong> Se nada aparecer → OK. Se retornar linhas → aplicar UPDATE.</p>
            </div>
          </div>
        </div>

        <!-- 5 Corrigindo Erros -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-5">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-5" aria-expanded="false" aria-controls="collapse-5">
              5. Corrigindo Erros (UPDATE)
            </button>
          </h2>
          <div id="collapse-5" class="accordion-collapse collapse" aria-labelledby="heading-5" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ol>
                <li>Copiar códigos retornados pelo SELECT (selecionar resultados → Ctrl+C).</li>
                <li>Colar no bloco UPDATE (substituir lista existente, separar por vírgula).</li>
                <li>Executar UPDATE — será exibido: "12 rows affected" ou similar.</li>
                <li>Opcional: rodar SELECT novamente para confirmar que retornou zero linhas.</li>
              </ol>

              <div class="mt-2">
                <label class="form-label small">Exemplo de UPDATE</label>
                <pre class="sql-block" id="exampleUpdate">UPDATE pedidos
SET tipo = 'repasse_correto'
WHERE id IN (123, 456, 789);</pre>
                <div class="d-flex gap-2 mt-2">
                  <button class="btn btn-sm btn-outline-secondary copy-btn" data-target="#exampleUpdate">Copiar UPDATE</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 6 Repetir -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-6">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-6" aria-expanded="false" aria-controls="collapse-6">
              6. Repetir o Processo para os Demais SELECTs
            </button>
          </h2>
          <div id="collapse-6" class="accordion-collapse collapse" aria-labelledby="heading-6" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <p class="mb-0">Passos idênticos para cada bloco: SELECT → verificar → copiar códigos → UPDATE → revalidar. Isso vale para primeiro bloco, segundo bloco e o bloco de comissões (mais extenso).</p>
            </div>
          </div>
        </div>

        <!-- 7 Comissões -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-7">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-7" aria-expanded="false" aria-controls="collapse-7">
              7. Etapa das Comissões
            </button>
          </h2>
          <div id="collapse-7" class="accordion-collapse collapse" aria-labelledby="heading-7" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <p class="mb-1"><strong>Observações:</strong></p>
              <ul>
                <li>Comissão depende de sua folha e da folha do colega (diferenças de estrutura).</li>
                <li>Sua folha: SELECTs separados dos UPDATEs (muito subir/ descer).</li>
                <li>Folha do instrutor: fluxo SELECT → UPDATE → SELECT → UPDATE (recomendado para comissões).</li>
              </ul>
              <p class="mb-0"><strong>Recomendação:</strong> terminar fechamento normal com sua folha; trocar para folha do instrutor para comissões.</p>
            </div>
          </div>
        </div>

        <!-- 8 Entendendo ajustes -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-8">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-8" aria-expanded="false" aria-controls="collapse-8">
              8. Entendendo o que está sendo ajustado
            </button>
          </h2>
          <div id="collapse-8" class="accordion-collapse collapse" aria-labelledby="heading-8" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ul>
                <li>Verificações incluem repasse incorreto, flags erradas, datas antigas (ex.: 2017) que impactam cálculo e divergências nas regras de comissão.</li>
                <li>UPDATEs não retornam tabela, apenas a mensagem de linhas afetadas.</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- 9 Fluxo da Comissão -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-9">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-9" aria-expanded="false" aria-controls="collapse-9">
              9. Fluxo da Comissão (resumo)
            </button>
          </h2>
          <div id="collapse-9" class="accordion-collapse collapse" aria-labelledby="heading-9" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <ol>
                <li>Rodar SELECT das comissões.</li>
                <li>Copiar códigos retornados.</li>
                <li>Inserir no UPDATE e rodar.</li>
                <li>Confirmar linhas afetadas e revalidar se quiser.</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- 10 Finalização -->
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-10">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-10" aria-expanded="false" aria-controls="collapse-10">
              10. Finalização
            </button>
          </h2>
          <div id="collapse-10" class="accordion-collapse collapse" aria-labelledby="heading-10" data-bs-parent="#manualAccordion">
            <div class="accordion-body">
              <p class="mb-0">Concluir quando todos os SELECTs retornarem zero resultados, todos os UPDATEs foram executados corretamente e dados de datas, códigos e comissões estiverem ajustados.</p>
            </div>
          </div>
        </div>

      </div>

      <!-- Interactive checklist and notes -->
      <div class="mt-3 small">
        <label class="form-label">Checklist</label>
        <div class="list-group checklist" id="checklist">
          <label class="list-group-item d-flex gap-2 align-items-center">
            <input type="checkbox" class="form-check-input mt-0 checkitem" data-step="1">
            <div>Fechamento processado no sistema</div>
          </label>
          <label class="list-group-item d-flex gap-2 align-items-center">
            <input type="checkbox" class="form-check-input mt-0 checkitem" data-step="2">
            <div>Folha SQL aberta e parâmetros ajustados</div>
          </label>
          <label class="list-group-item d-flex gap-2 align-items-center">
            <input type="checkbox" class="form-check-input mt-0 checkitem" data-step="3">
            <div>SELECTs de validação executados</div>
          </label>
          <label class="list-group-item d-flex gap-2 align-items-center">
            <input type="checkbox" class="form-check-input mt-0 checkitem" data-step="4">
            <div>UPDATEs aplicados e revalidados</div>
          </label>
          <label class="list-group-item d-flex gap-2 align-items-center">
            <input type="checkbox" class="form-check-input mt-0 checkitem" data-step="5">
            <div>Comissões processadas e confirmadas</div>
          </label>
        </div>
      </div>

      <div class="mt-3 d-flex justify-content-end gap-2">
        <button id="exportChecklist" class="btn btn-sm btn-success" style="background-color: deeppink; color: white; border: none">Exportar checklist</button>
        <button id="resetAll" class="btn btn-sm btn-outline-danger" style="border: none; background-color: deeppink; color: white">Resetar tudo</button>
      </div>
    </div>
  </div>

  <footer class="mt-3 text-center small manual-footer">
    <div class="mt-1">Documentação interna - Sistemas Stillos - By Beltis tecnologia 2025 © ADS Beltis 2025</div>
  </footer>
</div>

<!-- Bootstrap JS bundle (needed for accordion/collapse behavior) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="" crossorigin="anonymous"></script>

<!-- Local script (module) -->
<script type="module" src="js/script.js"></script>

</body>
</html>